<!--# include file="_start.html" -->
		<h1><span>О проекте</span></h1>
		<div class="block">
			<p><strong>CBSD</strong>&nbsp;&mdash; это обёртка из&nbsp;<strong>sh</strong>-скриптов (преимущественно) вокруг подсистемы <a href="http://www.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8" target="_blank">jail(8)</a> операционной системы <a href="http://www.freebsd.org" target="_blank">FreeBSD</a>, ориентированного на&nbsp;связывание различных особенностей FreeBSD, таких как racct, vnet, zfs, carp, hastd и&nbsp;так далее&nbsp;в&nbsp;один инструмент для более комплексного решения при построении серверов приложений, использующее заранее подготовленные jail-образы с&nbsp;типовым набором&nbsp;ПО и&nbsp;требующие минимальной настройки.</p>
			<p>Благодаря простоте базового функционала по&nbsp;созданию и&nbsp;удалению клеток (и&nbsp;я&nbsp;надеюсь, он&nbsp;таким и&nbsp;останется), в&nbsp;данный момент существует множество реализаций и&nbsp;надстроек над стандартным <a href="http://www.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8" target="_blank">jail(8)</a>, позволяя людям создавать и&nbsp;использовать собственные варианты по&nbsp;управлению jail, и&nbsp;<strong>CBSD</strong> является одним из&nbsp;них.</p>
			<p>Какого-либо нового функционала в&nbsp;ОС на&nbsp;данном этапе не&nbsp;внесено&nbsp;&mdash; всё, что могут делать скрипты <strong>CBSD</strong>, можно сделать командой (командами, десятками, сотнями команд) в&nbsp;CLI через соответствующие утилиты. Проект делается как для облегчения собственных нужд по&nbsp;администрированию клеток и&nbsp;серверов, так и &laquo;just for fun&raquo;.</p>
			<p>Из&nbsp;списка собственных нужд можно отметить следующие возможности:</p>
			<ul>
				<li>быстрое развертывание jail с&nbsp;нуля;</li>
				<li>экспорт и&nbsp;импорт jail в&nbsp;образ;</li>
				<li>клонирование и/или миграция jail (в&nbsp;т.ч. на&nbsp;удалённую машину);</li>
				<li>снапшоты jail;</li>
				<li>подсчёт трафика и&nbsp;потребляемых ресурсов на&nbsp;один jail;</li>
				<li>управление ресурсами jail (приоритезация (re-nice), RACCT/RCTL, файловые квоты);</li>
				<li>репликация jail на&nbsp;удалённые машины;</li>
				<li>дистрибьюция &laquo;типовых&raquo; jail, клеток с&nbsp;определённым набором софта и&nbsp;сервисами;</li>
				<li>WEB-интерфейс и&nbsp;централизованное управление фермой jail-ов;</li>
				<li><a href="/ru/xorg_in_jail.html">XJails</a> (Xorg в jail)</li>
				<li><a href="/ru/bhyve.html">Bhyve</a> (поддержка BSD Hypervisor)</li>
				<li>&hellip;</li>
			</ul>
		</div>
		
		<h2><a name="why">Пара ПОЧЕМУ&hellip;</a></h2>
		<div class="block">
			<p><strong>Q:</strong> &laquo;Что означает буква <strong>C</strong> в названии проекта?&raquo;</p>
			<ul>
				<li>По изначальной идее, <strong>C</strong>BSD означает &laquo;кластер BSD&raquo;, поскольку одна из целей проекта - получение одноранговой фермы серверов, обслуживающих большое количество клеток в одном
				пространстве, что позволяет клеткам мигрировать между нодами и делить между собой общий пул ресурсов. Молодому поколению разрешается вместо слова Cluster вставить Cloud, которое, тем не менее, лично я недолюбливаю:
				<ul>
					<li>Во-первых, слово Cloud повсеместно встречается в популярных статьях, однако этот термин не очень строгий и не всегда понятно, что имеется ввиду. Тем не менее, это не мешает маркетингу добавлять в любой сервис слово &laquo;Cloud&raquo; и теперь оно везде.</li>
					<li>Во-вторых то, что подразумевается под этим словом в целом, не является какой-либо новой технологий. Это лишь объединение нужным образом давно известных технологий.</li>
					<li>И наконец в-третьих, в старые добрые времена, слово &laquo;облако&raquo; означало красивый прекрасный атмосферный конденсат пара в небе, теперь же, первые 30 страниц поиска у Google по этому слову загажены всякой серверной ерундой.</li>
				</ul>
			</ul>
			<p><strong>Q:</strong> &laquo;В чем заключается кластеризация?&raquo;</p>
				<ul>
					<li>В качестве транспорта при общении одной ноды с другой используется SSH протокол, что обеспечивает шифрованный канал связи. При добавлении нод и обмене ключами, нода начинает реплицировать локальный реестр <strong>CBSD</strong> (SQlite3 база)
					на соседей. Например, если на Node1 погасить клетку jail2, то выполнив SQL запрос на Node2 по состоянию клетки jail2, данное изменение в статусе будет отражено.</li>
					<li>Добавленные друг на друга ноды представляют из себя одноранговую сеть. Другими словами, каждая нода может выполнить CBSD-команды на удаленной ноде с одинаковыми правами. Таким образом, имеется множественные точки входа для
					управления фермой - вы в состоянии зайти на одну ноду и с нее управлять состоянием и параметрами клеток, расположенные на соседних системах. При этом роль ACL и прав доступа - на совести front-end-ов.</li>
					<li>Через демон <a href="/ru/cbsd_taskd.html"><strong>taskd</strong></a> (очередь задач через SQLite3 базу), ноды могут ставить друг на друга долгие или отложенные задачи, при создании получая ID задачи и далее, контроллирующие по нему отработку и результат.</li>
					<li>Соединение SSH между участниками держится постоянно (опционально), выступая в роли некого heartbeat-а между нодами и мультиплексированием ssh для ускоренного вызова команд (те, является <strong>SSH ControlMaster</strong>-соединением, что исключает долгую handshake-стадию при удаленных командах)</li>
				</ul>
			<p><strong>Q:</strong> &laquo;Почему FreeBSD, почему Jail, почему&nbsp;sh, почему &hellip;&raquo;:</p>
			<p>FreeBSD/jail выбраны для проекта по&nbsp;ряду причин, наиболее важные из&nbsp;которых:</p>
			<ul>
				<li>Большая часть кода написана на&nbsp;<strong>sh</strong>&nbsp;по&nbsp;той причине, что подобные задачи не&nbsp;требуют большой математической логики &hellip; <a href="/ru/cbsdsh.html">подробнее</a></li>
				<li>CBSD зависит от&nbsp;следующего&nbsp;ПО: <strong>rsync</strong>, <strong>sudo</strong>, <strong>libssh2</strong>, <strong>sqlite3</strong>, все остальное - это базовый функционал ОС FreeBSD.</li>
				<li>Отсутствие у&nbsp;Jail <a href="/ru/articles/bhyve_vs_jails.html">накладных ресурсов</a> на&nbsp;виртуализацию. Без VIMAGE, код jail до&nbsp;сих пор имеет в&nbsp;ядре крайне мало своих if/case конструкций;</li>
				<li>Следование совету безопасников&nbsp;&mdash; &laquo;разделяй и&nbsp;властвуй&raquo;. Желательно каждый сервис или группу сервисов изолировать от&nbsp;других;</li>
				<li>Системным инженерам зачастую приходится делать массу однотипных инсталляций&nbsp;&mdash; AMP, MTA, KDE4, &hellip; в&nbsp;какой-то момент захотелось иметь заранее сформированное и&nbsp;настроенное окружение. Клеточный подход позволяет ввести сервер в&nbsp;экслуатацию мгновенно, после установки FreeBSD с&nbsp;нуля&nbsp;&mdash; для того, чтобы развернуть почтовый сервер или запустить KDE4, никаких настроек в&nbsp;мастер хосте делать не&nbsp;нужно&nbsp;&mdash; достаточно скачать заранее сформированное окружение по&nbsp;сети. Возможности создавать Desktop клетки имеют свою особую прелесть в&nbsp;виде остутствия в&nbsp;необходимости создавать 1024-ый по&nbsp;счёту дистрибутив, отличающийся от&nbsp;других только картинкой рабочего стола и&nbsp;набором ПО;</li>
				<li>Удобство бекапа и&nbsp;раскатывания клетки на&nbsp;свежеустановленную ноду;</li>
				<li>Построение собственных локальный репозиториев/библиотек клеток с&nbsp;кастомизированными опциями через <a href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/ports.html" target="_blank">FreeBSD ports</a>;</li>
				<li>При вышеупомянутом плюсе&nbsp;&mdash; отсутствие оверхеда на&nbsp;виртуализацию с&nbsp;соответствующим мониторингом, можно формировать максимально эффективные системы. Например, имеются клетки с&nbsp;NoSQL (Redis, Memcached)&nbsp;&mdash; плотная работа с&nbsp;памятью, клетка с&nbsp;MySQL&nbsp;&mdash; плотная работа с&nbsp;CPU, клетка с&nbsp;WEB-скриптами (CPU&amp;сеть), клетка с&nbsp;Samba (нагрузка на&nbsp;сеть и&nbsp;диски)&hellip; Каждую физическую ноду можно укомплектовать такими Jail, с&nbsp;которыми не&nbsp;будет простаивать ни&nbsp;один из&nbsp;аппаратных компонентов сервера и&nbsp;при этом клетки не&nbsp;будут друг другу мешать;</li>
				<li>На Linux аналогичных проектов тысячи, на FreeBSD - мне не известны;</li>
				<li>Не очень приятно жить в мире, в котором есть один только Linux, кроме этого, <strong>Vendor lock-in</strong> - штука плохая;</li>
				<li>&hellip;</li>
			</ul>
		</div>
		
		<h2><a name="features">Особенности&hellip;</a></h2>
		<div class="block">
			<ul>
				<li>готовый репозиторий для ядер и&nbsp;миров, что делает шаги <strong>buildworld/installworld</strong> необязательными;</li>
				<li>если шаги <strong>buildworld/installworld</strong> предпринимаются, поддерживается src.conf для кастомизации сборки;</li>
				<li>base каталог может располагаться на&nbsp;MD/RAM/TMPFS диске, что может быть полезно при большом кол-ве jail-ов с&nbsp;RO-подмонтированной базой;</li>
				<li>поддержка ZFS файловой системы, ZFS квот, ZFS снапшотов;</li>
				<li>GUI конфигуратор клеток (DIALOG/WEB);</li>
				<li>поддержка VIMAGE;</li>
				<li>подсчет трафика в&nbsp;jail;</li>
				<li>импортирование/экспортирование клеток;</li>
				<li>описания клеток;</li>
				<li>холодная миграция клетки с&nbsp;ноды на&nbsp;ноду;</li>
				<li>управление очередностью запуска jail и&nbsp;их&nbsp;приоритетом;</li>
				<li>поддержка RACCT/RCTL;</li>
				<li>репозиторий с&nbsp;готовыми template-клетками;</li>
				<li>репликация клетки;</li>
				<li>возможность создавать свои собственные сценарии для создания клеток;</li>
				<li>конвертирование jail в&nbsp;PXE/ISO/Memstick-имидж;</li>
				<li>поддержка ненативных архитектур клеток через Qemu User mode (например, клетки arm и&nbsp;mips64 архитектуры на&nbsp;x86-64&nbsp;ноде);</li>
				<li>&hellip;</li>
			</ul>
		</div>
		
		<h2><a name="goals">Цели проекта</a></h2>
		<div class="block">
			<ul>
				<li>Продемонстрировать возможности FreeBSD как хостинг платформы, не только для запуска jail, но и Linux окружений через BSD гипервизор;</li>
				<li>WEB панель для создания хостинга на своих собственных серверах;</li>
				<li>автоматизация типовых операций;</li>
				<li>удобный менеджмент, мониторинг и&nbsp;контроль за клетками;</li>
				<li>создание платформы для приложений по-требованию;</li>
				<li>библиотека образов;</li>
				<li>и&nbsp;не&nbsp;только&hellip;</li>
			</ul>
		</div>
<!--# include file="_end.html" -->